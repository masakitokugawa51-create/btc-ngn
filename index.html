<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
  <meta name="theme-color" content="#0A0A0A">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="BTC/NGN">
  
  <!-- SEO -->
  <title>Bitcoin to Naira Converter | BTC to NGN Live Rate | Free Calculator</title>
  <meta name="description" content="Convert Bitcoin to Nigerian Naira instantly. Free BTC to NGN calculator with live exchange rates updated every 15 seconds. Trusted by Nigerian crypto traders.">
  <meta name="keywords" content="bitcoin to naira, btc to ngn, bitcoin naira converter, bitcoin naira calculator, btc ngn rate, bitcoin price naira, crypto naira, bitcoin nigeria">
  <link rel="canonical" href="https://btc-ngn.vercel.app/">
  
  <!-- Open Graph -->
  <meta property="og:title" content="Bitcoin to Naira Converter | Live BTC/NGN Rate">
  <meta property="og:description" content="Convert Bitcoin to Nigerian Naira instantly with live rates. Free, fast, no signup required.">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://btc-ngn.vercel.app/">
  
  <!-- PWA -->
  <link rel="manifest" href="/manifest.json">
  <link rel="icon" type="image/png" sizes="192x192" href="/icon-192.png">
  <link rel="apple-touch-icon" href="/icon-192.png">
  
  <link rel="preconnect" href="https://api.coingecko.com">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Space+Mono:wght@400;700&family=DM+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">
  
  <!-- AdSense -->
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9202142689270811" crossorigin="anonymous"></script>

  <style>
    :root {
      --bg: #0A0A0A;
      --surface: #1A1A1E;
      --surface-active: #222226;
      --border: #2A2A2E;
      --text: #FAFAFA;
      --text-dim: #888892;
      --text-muted: #555560;
      --accent: #F7931A;
      --accent-glow: rgba(247, 147, 26, 0.12);
      --accent-border: rgba(247, 147, 26, 0.25);
      --ng-green: #008751;
      --ng-green-glow: rgba(0, 135, 81, 0.10);
      --ng-green-border: rgba(0, 135, 81, 0.25);
      --green: #00C853;
      --green-dim: rgba(0, 200, 83, 0.12);
      --red: #FF3B30;
      --red-dim: rgba(255, 59, 48, 0.12);
      --bybit-orange: #F7A600;
      --safe-top: env(safe-area-inset-top, 0px);
      --safe-bottom: env(safe-area-inset-bottom, 0px);
    }
    * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
    html, body {
      height: 100%;
      overflow-x: hidden;
      overflow-y: auto;
      background: var(--bg);
      color: var(--text);
      font-family: 'DM Sans', -apple-system, sans-serif;
      -webkit-font-smoothing: antialiased;
    }
    .app {
      display: flex; flex-direction: column; height: 100dvh; max-width: 480px; margin: 0 auto;
      padding: max(8px, var(--safe-top)) 16px max(8px, var(--safe-bottom));
    }
    .ad-slot {
      min-height: 50px; margin: 4px 0; display: flex; align-items: center; justify-content: center;
      background: var(--surface); border-radius: 10px; border: 1px solid var(--border);
      color: var(--text-muted); font-size: 11px; flex-shrink: 0; overflow: hidden;
    }
    .rate-bar { display: flex; align-items: center; justify-content: center; gap: 8px; padding: 10px 0; flex-shrink: 0; }
    .rate-label { color: var(--text-dim); font-size: 12px; }
    .rate-value { font-size: 14px; font-weight: 700; font-family: 'Space Mono', monospace; transition: color 0.3s; }
    .rate-value.up { color: var(--green); }
    .rate-value.down { color: var(--red); }
    .change-badge { font-size: 11px; font-weight: 600; padding: 2px 6px; border-radius: 6px; }
    .change-badge.positive { color: var(--green); background: var(--green-dim); }
    .change-badge.negative { color: var(--red); background: var(--red-dim); }
    .fields-wrapper { position: relative; flex-shrink: 0; }
    .field {
      display: flex; align-items: center; justify-content: space-between;
      padding: 18px 16px; border-radius: 16px; border: 2px solid var(--border);
      background: var(--surface); cursor: pointer; transition: all 0.2s;
      -webkit-user-select: none; user-select: none;
    }
    .field:active { transform: scale(0.98); }
    .field.active-btc { border-color: var(--accent-border); background: var(--accent-glow); }
    .field.active-ngn { border-color: var(--ng-green-border); background: var(--ng-green-glow); }
    .field + .field { margin-top: 10px; }
    .field-left { display: flex; align-items: center; }
    .currency-icon {
      width: 38px; height: 38px; border-radius: 50%; display: flex;
      align-items: center; justify-content: center; font-size: 20px; font-weight: 700; flex-shrink: 0;
    }
    .currency-icon.btc { background: #F7931A; color: #fff; font-family: 'Space Mono', monospace; }
    .currency-icon.ngn { background: var(--ng-green); }
    .currency-label { margin-left: 10px; font-size: 16px; font-weight: 600; }
    .field-value {
      font-size: 28px; font-weight: 600; font-family: 'Space Mono', monospace;
      text-align: right; flex: 1; margin-left: 12px; overflow: hidden; white-space: nowrap;
    }
    .field-value.dim { color: var(--text-dim); }
    .field-value.small { font-size: 20px; }
    .swap-btn {
      position: absolute; right: 12px; top: 50%; transform: translateY(-50%); z-index: 10;
      width: 44px; height: 44px; border-radius: 12px; background: var(--surface);
      border: 2px solid var(--border); display: flex; align-items: center; justify-content: center;
      cursor: pointer; box-shadow: 0 4px 12px rgba(0,0,0,0.4); font-size: 20px; font-weight: 700; color: var(--text);
      -webkit-user-select: none; user-select: none;
    }
    .swap-btn:active { transform: translateY(-50%) scale(0.9); }

    /* Bybit CTA */
    .cta-btn {
      display: flex; align-items: center; justify-content: center; gap: 8px;
      margin: 8px 0; padding: 14px 16px; border-radius: 12px;
      background: linear-gradient(135deg, #F7A600 0%, #F7931A 100%);
      color: #000; font-size: 15px; font-weight: 700; font-family: 'DM Sans', sans-serif;
      text-decoration: none; flex-shrink: 0;
      transition: transform 0.15s, opacity 0.15s;
      -webkit-user-select: none; user-select: none;
      touch-action: manipulation;
      box-shadow: 0 4px 16px rgba(247, 166, 0, 0.25);
    }
    .cta-btn:active { transform: scale(0.97); opacity: 0.9; }
    .cta-btn span.arrow { font-size: 18px; }

    .numpad {
      flex: 1; display: flex; flex-direction: column; gap: 10px;
      padding: 8px 0; justify-content: center;
    }
    .numpad-row { display: flex; gap: 10px; }
    .num-key {
      flex: 1; height: 58px; border-radius: 14px; background: var(--surface); border: none;
      color: var(--text); font-size: 24px; font-weight: 500; font-family: 'DM Sans', sans-serif;
      cursor: pointer; display: flex; align-items: center; justify-content: center;
      -webkit-user-select: none; user-select: none;
      touch-action: manipulation;
      -webkit-appearance: none;
      appearance: none;
      outline: none;
      position: relative;
      z-index: 1;
    }
    .num-key:active, .num-key.pressed {
      background: var(--surface-active);
      transform: scale(0.95);
    }
    .num-key.clear { background: var(--red-dim); color: var(--red); }
    .num-key.clear:active, .num-key.clear.pressed { background: rgba(255, 59, 48, 0.2); }
    .footer { text-align: center; padding: 4px 0 2px; flex-shrink: 0; }
    .footer-row { display: flex; align-items: center; justify-content: center; gap: 4px; }
    .footer-text { color: var(--text-muted); font-size: 12px; }
    .seo-footer {
      flex-shrink: 0; padding: 16px 0 8px; border-top: 1px solid var(--border);
      margin-top: 4px;
    }
    .seo-footer h2 { color: var(--text-dim); font-size: 11px; font-weight: 600; margin-bottom: 4px; }
    .seo-footer p { color: var(--text-muted); font-size: 10px; line-height: 1.4; }
    @media (max-height: 700px) {
      .num-key { height: 48px; font-size: 20px; }
      .numpad { gap: 6px; }
      .field { padding: 14px 16px; }
      .field-value { font-size: 24px; }
      .seo-footer { display: none; }
      .cta-btn { padding: 11px 16px; font-size: 14px; }
    }
    @media (max-height: 600px) {
      .num-key { height: 40px; font-size: 18px; }
      .ad-slot#adMid { display: none; }
    }
  </style>
</head>
<body>
<div class="app">
  <!-- Top Ad -->
  <div class="ad-slot" id="adTop">
    <ins class="adsbygoogle"
      style="display:block"
      data-ad-client="ca-pub-9202142689270811"
      data-ad-slot="auto"
      data-ad-format="auto"
      data-full-width-responsive="true"></ins>
    <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
  </div>

  <!-- Rate Bar -->
  <div class="rate-bar">
    <span class="rate-label">1 BTC =</span>
    <span class="rate-value" id="rateValue">Loading...</span>
    <span class="change-badge" id="changeBadge" style="display:none"></span>
  </div>

  <!-- Fields -->
  <div class="fields-wrapper">
    <div class="field active-btc" id="btcField">
      <div class="field-left">
        <div class="currency-icon btc">‚Çø</div>
        <span class="currency-label">BTC</span>
      </div>
      <span class="field-value" id="btcValue">0</span>
    </div>
    <div class="swap-btn" id="swapBtn">‚áÖ</div>
    <div class="field" id="ngnField">
      <div class="field-left">
        <div class="currency-icon ngn">üá≥üá¨</div>
        <span class="currency-label">NGN</span>
      </div>
      <span class="field-value dim" id="ngnValue">0</span>
    </div>
  </div>

  <!-- Bybit Affiliate CTA -->
  <a class="cta-btn" id="ctaBtn" href="https://www.bybitglobal.com/invite?ref=MMXLPO6" target="_blank" rel="noopener noreferrer">
    Buy Bitcoin on Bybit <span class="arrow">‚Üí</span>
  </a>

  <!-- Mid Ad -->
  <div class="ad-slot" id="adMid">
    <ins class="adsbygoogle"
      style="display:block"
      data-ad-client="ca-pub-9202142689270811"
      data-ad-slot="auto"
      data-ad-format="auto"
      data-full-width-responsive="true"></ins>
    <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
  </div>

  <!-- Numpad -->
  <div class="numpad" id="numpad">
    <div class="numpad-row">
      <button class="num-key" data-key="1" type="button">1</button>
      <button class="num-key" data-key="2" type="button">2</button>
      <button class="num-key" data-key="3" type="button">3</button>
    </div>
    <div class="numpad-row">
      <button class="num-key" data-key="4" type="button">4</button>
      <button class="num-key" data-key="5" type="button">5</button>
      <button class="num-key" data-key="6" type="button">6</button>
    </div>
    <div class="numpad-row">
      <button class="num-key" data-key="7" type="button">7</button>
      <button class="num-key" data-key="8" type="button">8</button>
      <button class="num-key" data-key="9" type="button">9</button>
    </div>
    <div class="numpad-row">
      <button class="num-key" data-key="." type="button">.</button>
      <button class="num-key" data-key="0" type="button">0</button>
      <button class="num-key clear" data-key="C" type="button">C</button>
    </div>
  </div>

  <!-- Footer -->
  <div class="footer">
    <div class="footer-row">
      <span style="font-size:11px">üîÑ</span>
      <span class="footer-text" id="footerText">Last updated --:--</span>
    </div>
  </div>

  <!-- SEO Footer -->
  <div class="seo-footer">
    <h2>Bitcoin to Naira Converter</h2>
    <p>Free BTC to NGN calculator with live exchange rates. Data from CoinGecko, updated every 15 seconds. Works offline.</p>
  </div>
</div>

<!-- Structured Data -->
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebApplication","name":"Bitcoin to Naira Converter","alternateName":"BTC to NGN Calculator","description":"Convert Bitcoin to Nigerian Naira instantly with live exchange rates.","applicationCategory":"FinanceApplication","operatingSystem":"Any","offers":{"@type":"Offer","price":"0","priceCurrency":"USD"}}
</script>

<script>
// ‚ïê‚ïê‚ïê FORCE CLEAR OLD CACHES ‚ïê‚ïê‚ïê
if ('caches' in window) {
  caches.keys().then(function(names) {
    for (var i = 0; i < names.length; i++) {
      if (names[i].indexOf('btc-ngn-v') >= 0 && names[i] !== 'btc-ngn-v3') {
        caches.delete(names[i]);
      }
    }
  });
}

// ‚ïê‚ïê‚ïê STATE ‚ïê‚ïê‚ïê
var amount = '0';
var direction = 'btc';
var rate = 0;
var prevRate = 0;
var change24h = 0;
var lastUpdated = null;
var retryDelay = 15000;

// ‚ïê‚ïê‚ïê DOM ‚ïê‚ïê‚ïê
var btcField = document.getElementById('btcField');
var ngnField = document.getElementById('ngnField');
var btcValue = document.getElementById('btcValue');
var ngnValue = document.getElementById('ngnValue');
var rateValueEl = document.getElementById('rateValue');
var changeBadge = document.getElementById('changeBadge');
var footerText = document.getElementById('footerText');

// ‚ïê‚ïê‚ïê FALLBACK RATE ‚ïê‚ïê‚ïê
var FALLBACK_RATE = 87000000;

// ‚ïê‚ïê‚ïê FETCH RATE ‚ïê‚ïê‚ïê
function fetchRate() {
  fetch('https://api.coingecko.com/api/v3/simple/price?ids=bitcoin&vs_currencies=ngn&include_24hr_change=true&include_last_updated_at=true')
    .then(function(r) {
      if (r.status === 429) {
        retryDelay = Math.min(retryDelay * 2, 120000);
        throw new Error('rate limited');
      }
      if (!r.ok) throw new Error('API error');
      retryDelay = 15000;
      return r.json();
    })
    .then(function(j) {
      var d = j.bitcoin;
      if (rate !== 0) prevRate = rate;
      rate = d.ngn;
      change24h = Math.round((d.ngn_24h_change || 0) * 100) / 100;
      lastUpdated = new Date(d.last_updated_at * 1000);
      try { localStorage.setItem('btc_ngn', JSON.stringify({rate: rate, change24h: change24h, ts: Date.now()})); } catch(e) {}
      updateUI();
    })
    .catch(function() {
      try {
        var c = localStorage.getItem('btc_ngn');
        if (c) {
          var d = JSON.parse(c);
          rate = d.rate; change24h = d.change24h; lastUpdated = new Date(d.ts);
          updateUI();
          return;
        }
      } catch(e) {}
      if (rate === 0) {
        rate = FALLBACK_RATE;
        change24h = 0;
        lastUpdated = new Date();
        updateUI();
        footerText.textContent = 'Offline - approximate rate';
      }
    });
}

// ‚ïê‚ïê‚ïê UPDATE UI ‚ïê‚ïê‚ïê
function updateUI() {
  var dir = rate > prevRate ? 'up' : rate < prevRate ? 'down' : '';
  var arrow = dir === 'up' ? '‚ñ≤ ' : dir === 'down' ? '‚ñº ' : '';
  rateValueEl.textContent = arrow + '‚Ç¶' + rate.toLocaleString('en-US');
  rateValueEl.className = 'rate-value ' + dir;

  if (change24h !== 0) {
    changeBadge.style.display = 'inline';
    changeBadge.textContent = (change24h > 0 ? '+' : '') + change24h + '%';
    changeBadge.className = 'change-badge ' + (change24h > 0 ? 'positive' : 'negative');
  } else {
    changeBadge.style.display = 'none';
  }

  if (lastUpdated) {
    footerText.textContent = 'Last updated ' + lastUpdated.toLocaleTimeString('en-US', {
      hour: '2-digit', minute: '2-digit', second: '2-digit', hour12: false
    });
  }
  updateConversion();
}

// ‚ïê‚ïê‚ïê CONVERSION ‚ïê‚ïê‚ïê
function updateConversion() {
  var n = parseFloat(amount) || 0;
  if (!rate) return;

  if (direction === 'btc') {
    btcValue.textContent = amount;
    btcValue.className = 'field-value' + (amount.length > 12 ? ' small' : '');
    if (n === 0) {
      ngnValue.textContent = '0';
      ngnValue.className = 'field-value dim';
    } else {
      var r = n * rate;
      var d;
      if (r >= 1e9) d = (r / 1e9).toFixed(2) + 'B';
      else if (r >= 1e6) d = (r / 1e6).toFixed(2) + 'M';
      else d = r.toLocaleString('en-US', {maximumFractionDigits: 0});
      ngnValue.textContent = d;
      ngnValue.className = 'field-value dim' + (d.length > 12 ? ' small' : '');
    }
  } else {
    ngnValue.textContent = amount;
    ngnValue.className = 'field-value' + (amount.length > 12 ? ' small' : '');
    if (n === 0) {
      btcValue.textContent = '0';
      btcValue.className = 'field-value dim';
    } else {
      var r2 = n / rate;
      var d2 = r2.toFixed(8);
      btcValue.textContent = d2;
      btcValue.className = 'field-value dim' + (d2.length > 12 ? ' small' : '');
    }
  }
}

// ‚ïê‚ïê‚ïê INTERACTIONS ‚ïê‚ïê‚ïê
function handleFieldTap(f) {
  if (direction === f) return;
  direction = f;
  amount = '0';
  btcField.className = f === 'btc' ? 'field active-btc' : 'field';
  ngnField.className = f === 'ngn' ? 'field active-ngn' : 'field';
  updateConversion();
}

function handleKey(k) {
  if (k === 'C') { amount = '0'; updateConversion(); return; }
  if (k === '.' && amount.indexOf('.') !== -1) return;
  if (amount === '0' && k !== '.') amount = k;
  else if (amount.length < 15) amount = amount + k;
  updateConversion();
}

function handleSwap() {
  direction = direction === 'btc' ? 'ngn' : 'btc';
  amount = '0';
  btcField.className = direction === 'btc' ? 'field active-btc' : 'field';
  ngnField.className = direction === 'ngn' ? 'field active-ngn' : 'field';
  updateConversion();
}

// ‚ïê‚ïê‚ïê NUMPAD EVENTS ‚ïê‚ïê‚ïê
var numpad = document.getElementById('numpad');

numpad.addEventListener('touchstart', function(e) {
  var btn = e.target.closest('.num-key');
  if (!btn) return;
  e.preventDefault();
  btn.classList.add('pressed');
  var key = btn.getAttribute('data-key');
  if (key) handleKey(key);
}, {passive: false});

numpad.addEventListener('touchend', function(e) {
  var btn = e.target.closest('.num-key');
  if (btn) btn.classList.remove('pressed');
}, {passive: true});

numpad.addEventListener('click', function(e) {
  var btn = e.target.closest('.num-key');
  if (!btn) return;
  var key = btn.getAttribute('data-key');
  if (key) handleKey(key);
});

// Field taps
btcField.addEventListener('click', function() { handleFieldTap('btc'); });
ngnField.addEventListener('click', function() { handleFieldTap('ngn'); });
btcField.addEventListener('touchstart', function(e) { e.preventDefault(); handleFieldTap('btc'); }, {passive: false});
ngnField.addEventListener('touchstart', function(e) { e.preventDefault(); handleFieldTap('ngn'); }, {passive: false});

// Swap button
var swapBtn = document.getElementById('swapBtn');
swapBtn.addEventListener('click', handleSwap);
swapBtn.addEventListener('touchstart', function(e) { e.preventDefault(); handleSwap(); }, {passive: false});

// ‚ïê‚ïê‚ïê KEYBOARD ‚ïê‚ïê‚ïê
document.addEventListener('keydown', function(e) {
  if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA') return;
  if (e.key >= '0' && e.key <= '9') handleKey(e.key);
  else if (e.key === '.') handleKey('.');
  else if (e.key === 'Backspace') {
    amount = amount.length <= 1 ? '0' : amount.slice(0, -1);
    updateConversion();
  }
  else if (e.key === 'Escape' || e.key === 'Delete') handleKey('C');
  else if (e.key === 'Tab') { e.preventDefault(); handleSwap(); }
});

// ‚ïê‚ïê‚ïê INIT ‚ïê‚ïê‚ïê
fetchRate();
setInterval(function() { fetchRate(); }, 15000);

// ‚ïê‚ïê‚ïê SERVICE WORKER ‚ïê‚ïê‚ïê
if ('serviceWorker' in navigator) {
  navigator.serviceWorker.getRegistrations().then(function(registrations) {
    for (var i = 0; i < registrations.length; i++) {
      registrations[i].unregister();
    }
  });
  setTimeout(function() {
    navigator.serviceWorker.register('/sw.js').catch(function(){});
  }, 2000);
}
</script>
</body>
</html>
